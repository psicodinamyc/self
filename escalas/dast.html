<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario DAST - HCPE</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">
    
    <style>
        body {
            font-family: 'EB Garamond', serif;
            background: linear-gradient(135deg, #dbe6f6, #727b88);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Navbar styling to match main project */
        .navbar {
            backdrop-filter: blur(10px);
            background-color: rgba(0, 0, 0, 0.6) !important;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .navbar-brand img {
            max-height: 40px;
            transition: transform 0.4s ease-in-out;
        }
        .navbar-brand img:hover {
            transform: scale(1.1);
        }
        @media print {
    body {
        background: white !important;
    }
    .btn, .form-control, .form-check-input {
        display: none !important;
    }
    .chart-container {
        display: none !important;
    }
}

@media (max-width: 768px) {
    .header-card, .question-card, .results-card {
        margin-bottom: 1rem;
    }
    h1 {
        font-size: 1.5rem;
    }
    .score-display {
        font-size: 2rem;
    }
}

    body {
        font-family: 'Segoe UI', Roboto, sans-serif;
        background-color: #f8f9fa;
        color: #212529;
    }

    h1, h5, h6 {
        font-weight: 600;
    }

    .header-card {
        margin-bottom: 2rem;
        border-left: 5px solid #0d6efd;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border-radius: 1rem;
    }

    .question-card {
        margin-bottom: 1.5rem;
        border: none;
        border-left: 4px solid #0d6efd;
        border-radius: 1rem;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
    }

    .question-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .question-text {
        font-weight: 500;
        font-size: 1.1rem;
    }

    .form-check-label {
        font-weight: 400;
    }

    .results-card {
        position: sticky;
        top: 20px;
        border-radius: 1rem;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }

    .results-card .card-header {
        border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .score-display {
        font-size: 2.5rem;
        font-weight: bold;
        text-align: center;
        margin: 1rem 0;
        color: #0d6efd;
    }

    .risk-level {
        font-weight: 500;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        margin-bottom: 0.75rem;
        font-size: 0.95rem;
    }

    .risk-0 {
        background-color: #e6f4ea;
        color: #14532d;
    }

    .risk-1 {
        background-color: #fff4e5;
        color: #92400e;
    }

    .risk-2 {
        background-color: #fff3cd;
        color: #856404;
    }

    .risk-3 {
        background-color: #f8d7da;
        color: #842029;
    }

    .chart-container {
        position: relative;
        height: 200px;
        margin-top: 1.5rem;
        background: #fff;
        border-radius: 0.5rem;
        padding: 1rem;
        box-shadow: inset 0 0 6px rgba(0,0,0,0.05);
    }

    .btn {
        font-weight: 500;
        border-radius: 0.5rem;
    }

    .btn i {
        margin-right: 0.5rem;
    }

    .alert-info {
        border-radius: 0.75rem;
        background-color: #e7f1ff;
        border-color: #b6daff;
        color: #084298;
    }

    input[type="text"], input[type="date"] {
        border-radius: 0.5rem;
    }
</style>

    <style>
        .header-card {
            margin-bottom: 2rem;
        }
        .question-card {
            margin-bottom: 1.5rem;
            border-left: 4px solid #0d6efd;
        }
        .question-text {
            font-weight: 500;
        }
        .results-card {
            position: sticky;
            top: 20px;
        }
        .score-display {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin: 1rem 0;
        }
        .interpretation-card {
            margin-top: 1.5rem;
        }
        .risk-level {
            font-weight: bold;
            padding: 0.5rem;
            border-radius: 0.25rem;
            margin-bottom: 0.5rem;
        }
        .risk-0 {
            background-color: #d1e7dd;
            color: #0f5132;
        }
        .risk-1 {
            background-color: #fff3cd;
            color: #664d03;
        }
        .risk-2 {
            background-color: #ffecb5;
            color: #664d03;
        }
        .risk-3 {
            background-color: #f8d7da;
            color: #842029;
        }
        .chart-container {
            position: relative;
            height: 200px;
            margin-bottom: 1.5rem;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark shadow sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="/images/index_logo.png" alt="Logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="/index.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Servicios</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Contacto</a></li>
                </ul>
                <div class="d-flex flex-wrap gap-2">
                    <a href="https://wa.me/543625314001" class="btn btn-success btn-sm" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                    <a href="https://facebook.com/mauricio.villamandos" class="btn btn-primary btn-sm" target="_blank"><i class="fab fa-facebook-f"></i> Facebook</a>
                    <a href="https://www.instagram.com/elperrofenrir/" class="btn btn-danger btn-sm" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>
                    <a href="https://twitter.com/tuusuario" class="btn btn-dark btn-sm" target="_blank"><i class="fab fa-x-twitter"></i> X</a>
                    <a href="https://linkedin.com/in/mauricio-villamandos-48b29a16a" class="btn btn-info btn-sm" target="_blank"><i class="fab fa-linkedin-in"></i> LinkedIn</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="bg-light py-4 mb-4 border-bottom">
        <div class="container text-center">
            <h1 class="display-5 fw-bold">Cuestionario DAST</h1>
            <div class="doctor-info">
                <p class="mb-1"><strong>Dr. Mauricio Villamandos - Médico Especialista en Psiquiatría - MP: 07489</strong></p>
                <p class="mb-0"><strong>Santa Ana, Corrientes – Argentina | infopsicodinamyc@gmail.com | Teléfono: 3765 041832</strong></p>
            </div>
        </div>
    </header>

<body class="bg-light">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="/images/index_logo.png" alt="Logo" height="40">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/index.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contacto</a>
                    </li>
                </ul>
                <div class="d-flex flex-wrap gap-2">
                    <a href="https://wa.me/543625314001?text=Hola%20Dr.%20Villamandos%2C%20quisiera%20hacer%20una%20consulta" 
                       target="_blank" class="btn btn-success btn-sm">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </a>
                    <a href="https://www.facebook.com/mauricio.villamandos?locale=es_LA" 
                       target="_blank" class="btn btn-primary btn-sm">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </a>
                    <a href="https://www.instagram.com/elperrofenrir/" 
                       target="_blank" class="btn btn-danger btn-sm">
                        <i class="fab fa-instagram"></i> Instagram
                    </a>
                    <a href="https://twitter.com/tuusuario" 
                       target="_blank" class="btn btn-dark btn-sm">
                        <i class="fab fa-x-twitter"></i> X
                    </a>
                    <a href="https://www.linkedin.com/in/mauricio-villamandos-48b29a16a" 
                       target="_blank" class="btn btn-info btn-sm">
                        <i class="fab fa-linkedin-in"></i> LinkedIn
                    </a>
                    
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="bg-light py-4 mb-4 border-bottom">
        <div class="container text-center">
            <h1 class="display-5 fw-bold">HCPE - Historia Clínica Psiquiátrica</h1>
            <div class="doctor-info">
                <p class="mb-1"><strong>Dr. Mauricio Villamandos - Médico Especialista en Psiquiatría - MP: 07489</strong></p>
                <p class="mb-0"><strong>Posadas, Misiones – Argentina | infopsicodinamyc@gmail.com | Teléfono: 3765 041832</strong></p>
            </div>
        </div>
    </header>
    
    <!-- Botonera de escalas e instrumentos -->
    <div class="container scales-toolbar no-print">
        <h4 class="w-100 text-center mb-3">Instrumentos de Evaluación</h4>
        <button class="btn btn-outline-primary" onclick="window.open('https://gonzalov85.github.io/Inventario-SCL-90-R/', '_blank')">
            <i class="fas fa-clipboard-list"></i> SCL-90-R
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/ham_d.html', '_blank')">
            <i class="fas fa-brain"></i> HAM-D
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/ham_d.html', '_blank')">
            <i class="fas fa-brain"></i> HAM-A
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/moca.html', '_blank')">
            <i class="fas fa-brain"></i> MoCA
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/mmse.html', '_blank')">
            <i class="fas fa-brain"></i> MMSE
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/panss.html', '_blank')">
            <i class="fas fa-brain"></i> PANSS
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/whoqol_breef.html', '_blank')">
            <i class="fas fa-brain"></i> WHOQOL-BREEF
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/barrero_s.html', '_blank')">
            <i class="fas fa-brain"></i> Barrero/S
            
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escalas/audit.html', '_blank')">
            <i class="fas fa-brain"></i> AUDIT
        </button>
    </div>

    <div class="container py-4">
        <div class="row">
            <div class="col-lg-8">
                <div class="card header-card">
                    <div class="card-body">
                        <h1 class="card-title text-center mb-4">Cuestionario de Detección de Drogas (DAST)</h1>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="patientName" class="form-label">Nombre</label>
                                <input type="text" class="form-control" id="patientName">
                            </div>
                            <div class="col-md-3">
                                <label for="patientDni" class="form-label">DNI</label>
                                <input type="text" class="form-control" id="patientDni">
                            </div>
                            <div class="col-md-3">
                                <label for="patientDate" class="form-label">Fecha</label>
                                <input type="date" class="form-control" id="patientDate">
                            </div>
                        </div>
                        
                        <div class="alert alert-info">
                            <strong>Instrucciones:</strong> El uso de drogas puede afectar su salud y a algunos medicamentos que podría estar consumiendo. Ayúdenos a darle la mejor atención médica contestando a las siguientes preguntas. Recuerde que esta escala solo es un instrumento aislado y debe ser correlacionado con una evaluación clínica profesional.
                        </div>
                    </div>
                </div>

                <!-- Preguntas del DAST -->
                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">1. ¿Ha consumido drogas distintas a las requeridas por razones médicas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q1" id="q1-yes" value="1">
                            <label class="form-check-label" for="q1-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q1" id="q1-no" value="0">
                            <label class="form-check-label" for="q1-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">2. ¿Abusa de más de un tipo de droga en un mismo día?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q2" id="q2-yes" value="1">
                            <label class="form-check-label" for="q2-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q2" id="q2-no" value="0">
                            <label class="form-check-label" for="q2-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">3. ¿Es capaz de dejar de consumir drogas cuando lo desea? (Puntuación invertida: No = 1 punto)</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q3" id="q3-yes" value="0">
                            <label class="form-check-label" for="q3-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q3" id="q3-no" value="1">
                            <label class="form-check-label" for="q3-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">4. ¿Ha tenido lagunas mentales o pérdidas de memoria como resultado del consumo de drogas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q4" id="q4-yes" value="1">
                            <label class="form-check-label" for="q4-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q4" id="q4-no" value="0">
                            <label class="form-check-label" for="q4-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">5. ¿Sus familiares o amigos alguna vez se han preocupado o quejado por su consumo de drogas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q5" id="q5-yes" value="1">
                            <label class="form-check-label" for="q5-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q5" id="q5-no" value="0">
                            <label class="form-check-label" for="q5-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">6. ¿Ha tenido problemas financieros como resultado de su consumo de drogas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q6" id="q6-yes" value="1">
                            <label class="form-check-label" for="q6-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q6" id="q6-no" value="0">
                            <label class="form-check-label" for="q6-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">7. ¿Ha intentado alguna vez reducir o dejar el consumo de drogas y no lo ha logrado?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q7" id="q7-yes" value="1">
                            <label class="form-check-label" for="q7-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q7" id="q7-no" value="0">
                            <label class="form-check-label" for="q7-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">8. ¿Ha consumido drogas por vía intravenosa?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q8" id="q8-yes" value="1">
                            <label class="form-check-label" for="q8-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q8" id="q8-no" value="0">
                            <label class="form-check-label" for="q8-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">9. ¿Ha tenido síntomas de abstinencia cuando ha dejado de consumir drogas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q9" id="q9-yes" value="1">
                            <label class="form-check-label" for="q9-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q9" id="q9-no" value="0">
                            <label class="form-check-label" for="q9-no">No</label>
                        </div>
                    </div>
                </div>

                <div class="card question-card">
                    <div class="card-body">
                        <h5 class="question-text">10. ¿Ha tenido problemas legales relacionados con su consumo de drogas?</h5>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q10" id="q10-yes" value="1">
                            <label class="form-check-label" for="q10-yes">Sí</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input dast-question" type="radio" name="q10" id="q10-no" value="0">
                            <label class="form-check-label" for="q10-no">No</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Columna de resultados -->
            <div class="col-lg-4">
                <div class="card results-card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">Resultados DAST</h5>
                    </div>
                    <div class="card-body">
                        <div class="score-display">
                            <span id="dast-score">0</span>
                            <div class="text-muted small">Puntuación total</div>
                        </div>

                        <div class="interpretation-card card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Interpretación</h6>
                            </div>
                            <div class="card-body">
                                <div id="interpretation-text">
                                    <p class="text-muted">Complete el cuestionario para ver la interpretación.</p>
                                </div>
                                
                                <div id="risk-level-0" class="risk-level risk-0 d-none">
                                    <strong>Zona I - Sin riesgo</strong><br>
                                    Sin riesgo de problemas de salud relacionados.
                                </div>
                                
                                <div id="risk-level-1" class="risk-level risk-1 d-none">
                                    <strong>Zona II - Riesgoso</strong><br>
                                    Riesgo de problemas de salud relacionados con el consumo de drogas.
                                </div>
                                
                                <div id="risk-level-2" class="risk-level risk-2 d-none">
                                    <strong>Zona III - Nocivo</strong><br>
                                    Riesgo de problemas de salud y posible trastorno por consumo de sustancias leve o moderado.
                                </div>
                                
                                <div id="risk-level-3" class="risk-level risk-3 d-none">
                                    <strong>Zona IV - Grave</strong><br>
                                    Riesgo de problemas de salud y posible trastorno por consumo de sustancias moderado o grave.
                                </div>
                            </div>
                        </div>

                        <div class="interpretation-card card mt-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Acción recomendada</h6>
                            </div>
                            <div class="card-body">
                                <div id="action-text">
                                    <p class="text-muted">Complete el cuestionario para ver las recomendaciones.</p>
                                </div>
                                
                                <div id="action-0" class="d-none">
                                    <p>Ninguna acción requerida.</p>
                                </div>
                                
                                <div id="action-1" class="d-none">
                                    <p><strong>Educación breve:</strong> Informar sobre los beneficios de abstenerse del consumo de drogas. Monitorizar en futuras visitas.</p>
                                    <p><strong>Intervención breve:</strong> Charla centrada en el paciente usando conceptos de Entrevista Motivacional.</p>
                                </div>
                                
                                <div id="action-2" class="d-none">
                                    <p><strong>Intervención breve:</strong> Ofrecer opciones que incluyan tratamiento.</p>
                                </div>
                                
                                <div id="action-3" class="d-none">
                                    <p><strong>Intervención breve:</strong> Ofrecer opciones que incluyan tratamiento.</p>
                                    <p><strong>Derivación:</strong> Considerar derivación a especialistas en tratamiento de drogas para evaluación completa.</p>
                                </div>
                            </div>
                        </div>

                        <div class="chart-container mt-3">
                            <canvas id="dastChart"></canvas>
                        </div>

                        <button id="print-btn" class="btn btn-primary w-100 mt-2">
                            <i class="bi bi-printer-fill"></i> Imprimir o Guardar
                        </button>
                        
                        <button id="reset-btn" class="btn btn-outline-secondary w-100 mt-2">
                            <i class="bi bi-arrow-counterclockwise"></i> Reiniciar
                        </button>
                    </div>
                     <footer class="footer">
        <div class="container">
            <div class="d-flex justify-content-center gap-3 mb-3">
                <button class="btn btn-primary btn-print no-print" onclick="imprimirDocumento()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-success btn-save no-print" onclick="guardarDocumento()">
                    <i class="fas fa-save"></i> Guardar
                </button>
                <button class="btn btn-info btn-export no-print" onclick="exportarAWord()">
                    <i class="fas fa-file-word"></i> Exportar a Word
                </button>
                <button class="btn btn-warning btn-next no-print" onclick="siguienteParte()">
                    <i class="fas fa-arrow-right"></i> Siguiente Parte
                </button>
            </div>
            
            <div>
            <p><strong>[HCPE] v2.0® &copy; 2025 - [Historia Clínica Psiquiátrica Electrónica]</strong></p>
            <p><strong>[Dr. Mauricio Villamandos / Ing. Fernando Gallardo]</strong></p>
            <p><strong>Posadas, Misiones - Argentina</strong></p>
            </div>
        </div>
    </footer>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar gráfico
            const ctx = document.getElementById('dastChart').getContext('2d');
            const dastChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Puntuación DAST'],
                    datasets: [{
                        label: 'Puntuación',
                        data: [0],
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10
                        }
                    }
                }
            });

            // Calcular puntuación cuando cambia cualquier radio button
            const radioButtons = document.querySelectorAll('.dast-question');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', calculateDASTScore);
            });

            // Botón de reinicio
            document.getElementById('reset-btn').addEventListener('click', function() {
                if(confirm('¿Estás seguro de que quieres reiniciar todos los valores?')) {
                    radioButtons.forEach(radio => {
                        radio.checked = false;
                    });
                    calculateDASTScore();
                    
                    // Limpiar datos del paciente
                    document.getElementById('patientName').value = '';
                    document.getElementById('patientDni').value = '';
                    document.getElementById('patientDate').value = '';
                }
            });

            // Botón de imprimir
            document.getElementById('print-btn').addEventListener('click', function() {
                window.print();
            });

            // Función para calcular la puntuación DAST
            function calculateDASTScore() {
                let score = 0;
                
                // Sumar puntos de las preguntas (la 3 tiene puntuación invertida)
                document.querySelectorAll('.dast-question:checked').forEach(item => {
                    score += parseInt(item.value);
                });
                
                // Actualizar puntuación
                document.getElementById('dast-score').textContent = score;
                dastChart.data.datasets[0].data = [score];
                dastChart.update();
                
                // Actualizar interpretación
                updateInterpretation(score);
            }

            // Función para actualizar la interpretación según la puntuación
            function updateInterpretation(score) {
                // Ocultar todos los niveles de riesgo primero
                document.querySelectorAll('[id^="risk-level-"], [id^="action-"]').forEach(el => {
                    el.classList.add('d-none');
                });
                
                // Mostrar el nivel de riesgo correspondiente
                let riskLevel = 0;
                let actionLevel = 0;
                
                if (score === 0) {
                    riskLevel = 0;
                    actionLevel = 0;
                } else if (score >= 1 && score <= 2) {
                    riskLevel = 1;
                    actionLevel = 1;
                } else if (score >= 3 && score <= 5) {
                    riskLevel = 2;
                    actionLevel = 2;
                } else if (score >= 6) {
                    riskLevel = 3;
                    actionLevel = 3;
                }
                
                document.getElementById(`risk-level-${riskLevel}`).classList.remove('d-none');
                document.getElementById(`action-${actionLevel}`).classList.remove('d-none');
                
                // Actualizar texto de interpretación
                const interpretationText = document.getElementById('interpretation-text');
                const actionText = document.getElementById('action-text');
                
                if (score === 0) {
                    interpretationText.innerHTML = '<p>Sin riesgo de problemas de salud relacionados con el consumo de drogas.</p>';
                } else {
                    interpretationText.innerHTML = '';
                }
            }
        });

        function updatePrintableData() {
    document.getElementById("print-name").textContent = document.getElementById("patientName").value;
    document.getElementById("print-dni").textContent = document.getElementById("patientDni").value;
    document.getElementById("print-date").textContent = document.getElementById("patientDate").value;
}

    document.getElementById("print-btn").addEventListener("click", updatePrintableData);

    </script>
    
    <div class="container mt-5 d-print-block">
        <hr>
        <div class="row">
            <div class="col-md-6">
                <p><strong>Paciente:</strong> <span id="print-name"></span></p>
                <p><strong>DNI:</strong> <span id="print-dni"></span></p>
                <p><strong>Fecha:</strong> <span id="print-date"></span></p>
            </div>
            <div class="col-md-6 text-end">
                <p><strong>Firma profesional:</strong></p>
                <div style="border-top: 1px solid #000; width: 60%; margin-left: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Dark mode toggle button -->
    <button class="dark-mode-toggle no-print" id="darkModeToggle" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; background: #2c3e50; color: white; border: none; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.2); transition: all 0.3s ease;">
        <i class="fas fa-moon"></i>
    </button>

    <footer class="bg-dark text-white py-3 mt-auto text-center">
        <div class="container">
            <p class="mb-1 small"><strong>[HCPE] v2.0® &copy; 2025 - [Historia Clínica Psiquiátrica Electrónica]</strong></p>
            <p class="mb-0 small"><strong>Dr. Mauricio Villamandos</strong></p>
            <p class="mb-2 small"><strong>Santa Ana, Corrientes - Argentina</strong></p>
        </div>
    </footer>

</body>
</html>