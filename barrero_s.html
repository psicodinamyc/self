<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación del Riesgo Suicida</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
     <link rel="stylesheet" href="/self-main/css/style o_o.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .underline {
            text-decoration: underline;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .question {
            font-weight: bold;
        }
        .score-input {
            width: 50px;
            text-align: center;
        }
        .result {
            font-size: 1.2em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .low-risk {
            background-color: #d4edda;
            color: #155724;
        }
        .medium-risk {
            background-color: #fff3cd;
            color: #856404;
        }
        .high-risk {
            background-color: #f8d7da;
            color: #721c24;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .note {
            font-style: italic;
            color: #666;
        }
    </style>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;700&family=Consolas&display=swap" rel="stylesheet">
</head>
<body>
    
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="/self-main/images/logo.jpg" alt="Logo" height="40">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/self-main/index.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contacto</a>
                    </li>
                </ul>
                <div class="d-flex flex-wrap gap-2">
                    <a href="https://wa.me/543625314001?text=Hola%20Dr.%20Villamandos%2C%20quisiera%20hacer%20una%20consulta" 
                       target="_blank" class="btn btn-success btn-sm">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </a>
                    <a href="https://www.facebook.com/mauricio.villamandos?locale=es_LA" 
                       target="_blank" class="btn btn-primary btn-sm">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </a>
                    <a href="https://www.instagram.com/elperrofenrir/" 
                       target="_blank" class="btn btn-danger btn-sm">
                        <i class="fab fa-instagram"></i> Instagram
                    </a>
                    <a href="https://twitter.com/tuusuario" 
                       target="_blank" class="btn btn-dark btn-sm">
                        <i class="fab fa-x-twitter"></i> X
                    </a>
                    <a href="https://www.linkedin.com/in/mauricio-villamandos-48b29a16a" 
                       target="_blank" class="btn btn-info btn-sm">
                        <i class="fab fa-linkedin-in"></i> LinkedIn
                    </a>
                    
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="bg-light py-4 mb-4 border-bottom">
        <div class="container text-center">
            <h1 class="display-5 fw-bold">HCPE - Historia Clínica Psiquiátrica</h1>
            <div class="doctor-info">
                <p class="mb-1"><strong>Dr. Mauricio Villamandos - Médico Especialista en Psiquiatría - MP: 07489</strong></p>
                <p class="mb-0"><strong>Posadas, Misiones – Argentina | infopsicodinamyc@gmail.com | Teléfono: 3765 041832</strong></p>
            </div>
        </div>
    </header>
    
    
    </div>

<main>
    <body>
    
    

    
    
    <!-- Botonera de escalas e instrumentos -->
    <div class="container scales-toolbar no-print">
        <h4 class="w-100 text-center mb-3">Instrumentos de Evaluación</h4>
        <button class="btn btn-outline-primary" onclick="window.open('https://gonzalov85.github.io/Inventario-SCL-90-R/', '_blank')">
            <i class="fas fa-clipboard-list"></i> SCL-90-R
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('/self-main/ham_d.html', '_blank')">
            <i class="fas fa-brain"></i> HAM-D
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_ham_a.html', '_blank')">
            <i class="fas fa-brain"></i> HAM-A
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_moca.html', '_blank')">
            <i class="fas fa-brain"></i> MoCA
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_mmse.html', '_blank')">
            <i class="fas fa-brain"></i> MMSE
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_panss.html', '_blank')">
            <i class="fas fa-brain"></i> PANSS
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_ymrs.html', '_blank')">
            <i class="fas fa-brain"></i> YMRS
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_cage.html', '_blank')">
            <i class="fas fa-brain"></i> CAGE
        </button>
        <button class="btn btn-outline-primary" onclick="window.open('escala_audit.html', '_blank')">
            <i class="fas fa-brain"></i> AUDIT
        </button>
    </div>

    <main class="container">
        <section class="form-section">
            <h1>1. DATOS GENERALES</h1>
            
            <!-- Primera fila compacta -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Lugar de evaluación:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Fecha de evaluación:</label>
                    <input type="date" class="form-control">
                </div>
                <div class="form-group">
                    <label>Modalidad:</label>
                    <select class="form-control">
                        <option value="">Presencial</option>
                        <option value="virtual">Virtual</option>
                        <option value="domicilio">Domicilio</option>
                        <option value="urgencia">Urgencia</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Código del paciente:</label>
                    <input type="text" class="form-control">
                </div>
            </div>
            
            <!-- Datos personales agrupados -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Nombre:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Apellido:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>DNI:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Nacionalidad:</label>
                    <select class="form-control">
                        <option value="">Seleccione...</option>
                        <option value="Argentina">Argentino/a</option>
                        <option value="Paraguay">Paraguayo/a</option>
                        <option value="Brasil">Brasilero/a</option>
                        <option value="Uruguay">Uruguayo/a</option>
                        <option value="Otros">Otros</option>
                    </select>
                </div>
            </div>
            
            <!-- Datos demográficos -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Sexo/género:</label>
                    <select class="form-control">
                        <option value="">Seleccione...</option>
                        <option value="masculino">Masculino</option>
                        <option value="femenino">Femenino</option>
                        <option value="otro">Otro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha de nacimiento:</label>
                    <input type="date" id="fecha-nacimiento" name="fecha-nacimiento" required onchange="calcularEdad(this.value)">
                </div>
                <div class="form-group">
                    <label>Edad actual:</label>
                    <input type="text" id="edad" name="edad" readonly>
                </div>
                <div class="form-group">
                    <label>Estado civil:</label>
                    <select class="form-control">
                        <option value="">Seleccione...</option>
                        <option value="soltero">Soltero</option>
                        <option value="casado">Casado</option>
                        <option value="viudo">Viudo</option>
                        <option value="divorciado">Divorciado</option>
                        <option value="concubinato">Concubinato</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
            </div>
            
            <!-- Información de contacto -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Domicilio:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>C.P.:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Celular:</label>
                    <input type="tel" class="form-control">
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" class="form-control">
                </div>
            </div>
            
            <!-- Información profesional y de salud -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Ocupación:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Escolaridad:</label>
                    <select class="form-control">
                        <option value="">Seleccione...</option>
                        <option value="primario">Primario</option>
                        <option value="secundario">Secundario</option>
                        <option value="terciario">Terciario</option>
                        <option value="universitario">Universitario</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Obra social:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Número:</label>
                    <input type="text" class="form-control">
                </div>
            </div>
            
            <!-- Contactos de referencia -->
            <div class="form-grid">
                <div class="form-group">
                    <label>Referente 1:</label>
                    <input type="text" class="form-control" placeholder="nombre y apellido">
                </div>
                <div class="form-group">
                    <label>Contacto:</label>
                    <input type="tel" class="form-control">
                </div>
                <div class="form-group">
                    <label>Relación:</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Psicólogo/a:</label>
                    <input type="text" class="form-control" placeholder="nombre y apellido">
                </div>
            </div>
            
            <!-- Observaciones -->
            <div class="form-group">
                <label>Observaciones:</label>
                <textarea class="form-control" id="observaciones-generales"></textarea>
                <div class="voice-controls">
                    <button onclick="iniciarDictado('observaciones-generales')" class="btn btn-sm btn-outline-secondary">
                        <i class="fas fa-microphone"></i> Dictar
                    </button>
                    <button onclick="leer('observaciones-generales')" class="btn btn-sm btn-outline-secondary">
                        <i class="fas fa-volume-up"></i> Leer
                    </button>
                    <select id="vozSelect" class="form-select form-select-sm" style="width: auto;">
                        <option value="">Seleccionar voz...</option>
                    </select>
                </div>
            </div>
        </section>

</main>
    <h1>Guía práctica para evaluación del riesgo suicida</h1>
    <p class="underline">Basado en estudios del Dr. Sergio Pérez Barrero y cols.</p>
    
    <p>Si bien no existe en la actualidad ningún instrumento de evaluación psicométrica que pueda predecir en un 100% el riesgo suicida de un paciente ya que estos se caracterizan por su imprevisibilidad muchas veces, algunos autores intentan abordar la problemática y diseñan algunas herramientas basándose en su experiencia clínica y estadísticas; además de algunos criterios que pueden ser de utilidad a la hora de evaluar a un paciente.</p>
    
    <h2>Instrucciones:</h2>
    <p>Para cada una de las siguientes preguntas, seleccione el puntaje correspondiente según la observación. El sistema calculará automáticamente el total.</p>
    <p class="underline">Si la suma de la puntuación de todos los ítems sobrepasa los <strong>18 puntos</strong> el sujeto debe ser trasladado a recibir atención psiquiátrica de urgencia ya que el peligro de suicidio es muy elevado.</p>
    
    <table>
        <thead>
            <tr>
                <th>Pregunta</th>
                <th>Observación</th>
                <th>Puntaje</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="question">1) ¿Los familiares temen que el sujeto realice un intento de suicidio?</td>
                <td>Mediante esta pregunta se recabará cualquier conducta anómala o expresión verbal que haga sospechar a los familiares la posibilidad. Por su estrecha vinculación con las familias este aspecto es de fácil abordaje por los médicos de familia, aunque también por amigos íntimos, familiares y otros parientes.</td>
                <td><select class="score-input" id="q1" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="3">3</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">2) ¿Actitud poco colaboradora del sujeto durante la entrevista?</td>
                <td>La ambivalencia o el negativismo al entrevistar a un individuo con riesgo suicida es muy importante a tener en cuenta. En este ítem se propone no calificar la conducta del individuo en términos que pudieran ser poco usuales o desconocidos para el entrevistador.</td>
                <td><select class="score-input" id="q2" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="3">3</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">3) ¿El sujeto manifiesta deseos de morir?</td>
                <td>Si el sujeto coopera, puede manifestar tales deseos, lo cual denota inconformidad del mismo con su propia existencia y es el preludio de una futura ideación suicida.</td>
                <td><select class="score-input" id="q3" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="2">2</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">4) ¿El individuo manifiesta ideas suicidas?</td>
                <td>Mediante este ítem se intenta evaluar la presencia de ideas suicidas en el sujeto en el momento presente (el "aquí y ahora").</td>
                <td><select class="score-input" id="q4" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="4">4</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">5) ¿El sujeto expone un plan suicida?</td>
                <td>Evidentemente no es lo mismo tener deseos de morir o pensar en quitarse la vida sin precisar como hacerlo, que elaborar o planificar como llevarlo a vías de hecho, lo cual es de extrema gravead para la supervivencia de la persona.</td>
                <td><select class="score-input" id="q5" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="5">5</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">6) ¿El individuo tiene antecedentes de trastornos psiquiátricos?</td>
                <td>Mediante este ítem se recaban los antecedentes patológicos personales de la enfermedad mental sin que el medico u otro personal paramédico o voluntario se enfrenten a la necesidad de realizar un diagnóstico psiquiátrico preciso.</td>
                <td><select class="score-input" id="q6" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="4">4</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">7) ¿El sujeto tiene antecedentes de hospitalización psiquiátrica reciente?</td>
                <td>Este ítem se tiene en cuenta debido a la frecuencia con que ocurre en los egresados de un servicio psiquiátrico, principalmente durante los primeros 6 meses.</td>
                <td><select class="score-input" id="q7" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="2">2</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">8) ¿El individuo tiene antecedentes de intento de suicidio?</td>
                <td>Es reconocido que entre el 1% a 2% de los sujetos que realizan un acto suicida, se suicidan durante el primer año y entre un 10% a 20% en el resto de sus vidas lo que justifica su inclusión en esta guía.</td>
                <td><select class="score-input" id="q8" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="3">3</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">9) ¿El sujeto tiene antecedentes familiares de conducta suicida?</td>
                <td>William Farr en 1841 sentenció: "No hay un hecho mejor establecido que el efecto imitativo en la conducta suicida" y en la actualidad se menciona el papel que juegan los medios de difusión masiva en la génesis del suicidio cuando esta temática no es bien tratada.</td>
                <td><select class="score-input" id="q9" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="3">3</option>
                </select></td>
            </tr>
            <tr>
                <td class="question">10) ¿Presencia de un conflicto actual familiar o de pareja?</td>
                <td>Independientemente de que no son estos los únicos conflictos que pueden precipitar un intento de suicidio o un suicidio, las evidencias los consideran entre los más frecuentes en cualquier latitud y cultura.</td>
                <td><select class="score-input" id="q10" onchange="calculateScore()">
                    <option value="0">0</option>
                    <option value="2">2</option>
                </select></td>
            </tr>
        </tbody>
    </table>
    
    <div id="result" class="result">
        Puntuación total: <span id="totalScore">0</span> puntos
    </div>
    
    <div id="recommendation" class="result low-risk">
        Riesgo bajo: El paciente no presenta un riesgo suicida significativo según esta evaluación.
    </div>
    
    <button onclick="printEvaluation()">Imprimir Evaluación</button>
    
    <p class="note">Nota: Este instrumento no sustituye el juicio clínico profesional. Siempre considere el contexto completo del paciente.</p>
    
</main>
    
    <script>
        function calculateScore() {
            let total = 0;
            
            // Sumar todos los valores seleccionados
            for (let i = 1; i <= 10; i++) {
                const value = parseInt(document.getElementById(`q${i}`).value);
                total += value;
            }
            
            // Actualizar el total
            document.getElementById('totalScore').textContent = total;
            
            // Actualizar la recomendación según el puntaje
            const recommendation = document.getElementById('recommendation');
            
            if (total === 0) {
                recommendation.textContent = "Riesgo bajo: El paciente no presenta un riesgo suicida significativo según esta evaluación.";
                recommendation.className = "result low-risk";
            } else if (total <= 18) {
                recommendation.textContent = "Riesgo moderado: El paciente muestra algunos factores de riesgo que requieren atención y seguimiento.";
                recommendation.className = "result medium-risk";
            } else {
                recommendation.textContent = "RIESGO ALTO: El paciente debe ser trasladado a recibir atención psiquiátrica de urgencia. El peligro de suicidio es muy elevado (puntuación > 18).";
                recommendation.className = "result high-risk";
            }
        }
        
        function printEvaluation() {
            window.print();
        }
    </script>

    <div class="signature-section">
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <p>_____________________________________</p>
            <br>
            <br>
            <p>Firma y sello profesional</p>
            <p><strong>Dr. Mauricio Villamandos</strong></p>
            <p>Psiquiatra - M.P.: 07489</p>
            <div class="signature-line"></div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="d-flex justify-content-center gap-3 mb-3">
                <button class="btn btn-primary btn-print no-print" onclick="imprimirDocumento()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-success btn-save no-print" onclick="guardarDocumento()">
                    <i class="fas fa-save"></i> Guardar
                </button>
                <button class="btn btn-info btn-export no-print" onclick="exportarAWord()">
                    <i class="fas fa-file-word"></i> Exportar a Word
                </button>
                <button class="btn btn-warning btn-next no-print" onclick="siguienteParte()">
                    <i class="fas fa-arrow-right"></i> Siguiente Parte
                </button>
            </div>
            <p><strong>[HCPE] v2.0 &copy; 2025 - [Historia Clínica Psiquiátrica Electrónica]</strong></p>
            <p><strong>Dr. Mauricio Villamandos - MP: 07489</strong></p>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- FileSaver.js para exportar a Word -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <!-- Docx.js para generar documentos Word -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    
    <script>
        // Función para calcular la edad
        function calcularEdad(fechaNacimiento) {
            const fechaNac = new Date(fechaNacimiento);
            const hoy = new Date();
            let edad = hoy.getFullYear() - fechaNac.getFullYear();
            const mes = hoy.getMonth() - fechaNac.getMonth();
            
            if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNac.getDate())) {
                edad--;
            }
            
            document.getElementById('edad').value = edad;
        }
        
        // Variables para reconocimiento de voz
        let reconocimiento;
        let vocesDisponibles = [];
        
        // Función para iniciar dictado
        function iniciarDictado(idCampo) {
            const campo = document.getElementById(idCampo);
            window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        
            if (!window.SpeechRecognition) {
                alert("Tu navegador no soporta reconocimiento de voz.");
                return;
            }
        
            reconocimiento = new SpeechRecognition();
            reconocimiento.lang = 'es-ES';
            reconocimiento.continuous = false;
            reconocimiento.interimResults = false;
        
            reconocimiento.onresult = (event) => {
                const resultado = event.results[0][0].transcript;
                campo.value += (campo.value ? " " : "") + resultado;
            };
        
            reconocimiento.onerror = (event) => {
                console.error('Error en el reconocimiento de voz:', event.error);
            };
        
            reconocimiento.start();
        }
        
        // Función para cargar las voces disponibles
        function cargarVoces() {
            vocesDisponibles = window.speechSynthesis.getVoices();
            const select = document.getElementById("vozSelect");
            select.innerHTML = "";
            
            const opcionDefault = document.createElement("option");
            opcionDefault.value = "";
            opcionDefault.textContent = "Seleccionar voz...";
            select.appendChild(opcionDefault);
            
            vocesDisponibles.forEach((voz, i) => {
                const option = document.createElement("option");
                option.value = i;
                option.textContent = `${voz.name} (${voz.lang})`;
                select.appendChild(option);
            });
        }
        
        // Evento cuando las voces cambian
        window.speechSynthesis.onvoiceschanged = cargarVoces;
        
        // Función para leer texto
        function leer(idCampo) {
            const texto = document.getElementById(idCampo).value;
            if (!texto.trim()) {
                alert("El campo está vacío.");
                return;
            }
        
            const mensaje = new SpeechSynthesisUtterance(texto);
            const vozSeleccionada = document.getElementById("vozSelect").value;
            
            if (vozSeleccionada && vocesDisponibles[vozSeleccionada]) {
                mensaje.voice = vocesDisponibles[vozSeleccionada];
                mensaje.lang = vocesDisponibles[vozSeleccionada].lang;
            } else {
                // Buscar una voz en español por defecto
                const vozEspanol = vocesDisponibles.find(voz => voz.lang.includes('es'));
                if (vozEspanol) {
                    mensaje.voice = vozEspanol;
                    mensaje.lang = vozEspanol.lang;
                }
            }
            
            window.speechSynthesis.speak(mensaje);
        }
        
        // Cargar voces al inicio
        document.addEventListener('DOMContentLoaded', cargarVoces);
        
        // Función para imprimir el documento
        function imprimirDocumento() {
            window.print();
        }
        
        // Función para guardar el documento
        function guardarDocumento() {
            // Aquí puedes implementar la lógica para guardar en base de datos o localStorage
            alert("Documento guardado correctamente.");
        }
        
        // Función para exportar a Word
        function exportarAWord() {
            const { Document, Paragraph, TextRun, Packer } = docx;
            
            // Crear un array con todos los párrafos del documento
            const docContent = [];
            
            // Agregar título del documento
            docContent.push(
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "HISTORIA CLÍNICA PSIQUIÁTRICA ELECTRÓNICA",
                            bold: true,
                            size: 28,
                        }),
                    ],
                    spacing: { after: 200 },
                })
            );
            
            // Agregar información del profesional
            docContent.push(
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Dr. Mauricio Villamandos - Médico Especialista en Psiquiatría - MP: 07489",
                            bold: true,
                        }),
                    ],
                }),
                new Paragraph({
                    children: [
                        new TextRun({
                            text: "Posadas, Misiones – Argentina | infopsicodinamyc@gmail.com | Teléfono: 3765 041832",
                        }),
                    ],
                    spacing: { after: 400 },
                })
            );
            
            // Función para agregar secciones
            function agregarSeccion(titulo, contenido) {
                docContent.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: titulo,
                                bold: true,
                                size: 22,
                            }),
                        ],
                        spacing: { before: 400, after: 200 },
                    })
                );
                
                if (typeof contenido === 'string') {
                    docContent.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: contenido,
                                }),
                            ],
                            spacing: { after: 200 },
                        })
                    );
                } else if (Array.isArray(contenido)) {
                    contenido.forEach(item => {
                        docContent.push(
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: item,
                                    }),
                                ],
                                indent: { left: 400 },
                                spacing: { after: 100 },
                            })
                        );
                    });
                }
            }
            
            // Agregar datos generales
            const lugarEvaluacion = document.querySelector('input[type="text"]').value;
            const fechaEvaluacion = document.querySelector('input[type="date"]').value;
            const nombre = document.querySelectorAll('input[type="text"]')[3].value;
            const apellido = document.querySelectorAll('input[type="text"]')[4].value;
            
            agregarSeccion("1. DATOS GENERALES", [
                `Lugar de evaluación: ${lugarEvaluacion}`,
                `Fecha de evaluación: ${fechaEvaluacion}`,
                `Paciente: ${nombre} ${apellido}`,
                // Agregar más datos según sea necesario
            ]);
            
            // Agregar motivo de consulta
            const motivoConsulta = document.getElementById('motivoConsulta').value;
            agregarSeccion("2. MOTIVO DE CONSULTA", motivoConsulta);
            
            // Agregar antecedentes de enfermedad actual
            const antecedentesEnfermedad = document.getElementById('antecedentesEnfermedad').value;
            agregarSeccion("3. ANTECEDENTES DE ENFERMEDAD ACTUAL", antecedentesEnfermedad);
            
            // Continuar con las demás secciones...
            
            // Crear el documento
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: docContent,
                }],
            });
            
            // Generar el archivo Word
            Packer.toBlob(doc).then(blob => {
                saveAs(blob, "Historia_Clinica_Psiquiatrica.docx");
            });
        }
        
        // Función para ir a la siguiente parte
        function siguienteParte() {
            // Aquí puedes implementar la navegación a otra parte del formulario
            alert("Funcionalidad de siguiente parte en desarrollo.");
        }
    </script>

<script>
function exportarWord() {
  const content = document.getElementById('formulario');
  const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                 "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                 "xmlns='http://www.w3.org/TR/REC-html40'>" +
                 "<head><meta charset='utf-8'><title>Exportar</title></head><body>";
  const footer = "</body></html>";
  const sourceHTML = header + content.innerHTML + footer;

  const blob = new Blob(['﻿', sourceHTML], {
    type: 'application/msword'
  });

  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  link.download = "Historia_Clinica.doc";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>

<script src="/self-main/js/world_script.js"></script>

</body>

</html>