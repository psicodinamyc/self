<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Montreal Cognitive Assessment (MoCA)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            text-align: center;
        }
        .header-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .header-info div {
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .section-title {
            font-weight: bold;
            background-color: #f2f2f2;
        }
        .score-input {
            width: 40px;
            text-align: center;
        }
        .result {
            font-size: 1.2em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        .normal {
            background-color: #d4edda;
            color: #155724;
        }
        .suspicious {
            background-color: #fff3cd;
            color: #856404;
        }
        .abnormal {
            background-color: #f8d7da;
            color: #721c24;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            margin: 20px auto;
        }
        button:hover {
            background-color: #2980b9;
        }
        .note {
            font-style: italic;
            color: #666;
            text-align: center;
        }
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .centered {
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>MONTREAL COGNITIVE ASSESSMENT (MoCA)</h1>
    <p class="centered"><strong>Versión 7.1 - Nasreddine et al. (2005)</strong></p>
    
    <div class="header-info">
        <div>
            <strong>NOMBRE:</strong> <input style="width: 200px;" type="text"/><br/>
            <strong>FECHA:</strong> <input type="date"/><br/>
            <strong>EDUCACIÓN:</strong> 
            <select id="education" onchange="calculateScore()">
                <option value="0">≤12 años</option>
                <option value="1">>12 años</option>
            </select>
        </div>
        <div>
            <strong>EDAD:</strong> <input type="number" min="18" max="120"/><br/>
            <strong>SEXO:</strong>
            <select>
                <option value="male">Varón</option>
                <option value="female">Mujer</option>
            </select><br/>
            <strong>OBSERVACIONES:</strong> <input style="width: 150px;" type="text"/>
        </div>
    </div>

    <h3>1. Tarea de Alternancia (Funciones Ejecutivas) - Máx. 1 punto</h3>
    <p>Dibujar una línea alternando entre números y letras: 1-A-2-B-3-C-4-D-5-E</p>
    <select class="score-input" id="alternancia" onchange="calculateScore()">
        <option value="0">0 (Error)</option>
        <option value="1">1 (Correcto)</option>
    </select>

    <h3>2. Copia de Cubo (Visuoespacial) - Máx. 1 punto</h3>
    <p>Copiar el dibujo de un cubo tridimensional:</p>
    <select class="score-input" id="cubo" onchange="calculateScore()">
        <option value="0">0 (Error)</option>
        <option value="1">1 (Correcto)</option>
    </select>

    <h3>3. Reloj (Visuoespacial/Ejecutivo) - Máx. 3 puntos</h3>
    <p>Dibujar un reloj marcando las 11:10:</p>
    <div class="two-columns">
        <div>
            <p><strong>Contorno</strong> <select class="score-input" id="reloj-contorno" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Números</strong> <select class="score-input" id="reloj-numeros" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Manecillas</strong> <select class="score-input" id="reloj-manecillas" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>4. Denominación (Lenguaje) - Máx. 3 puntos</h3>
    <p>Nombrar: León, Rinoceronte, Camello</p>
    <div class="two-columns">
        <div>
            <p><strong>León</strong> <select class="score-input" id="leon" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Rinoceronte</strong> <select class="score-input" id="rinoceronte" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Camello</strong> <select class="score-input" id="camello" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>5. Memoria (Repetición Inmediata) - Máx. 5 puntos</h3>
    <p>Repetir: "Cara, Velcro, Iglesia, Azul, Cielo" (2 intentos, mejor puntuación)</p>
    <div class="two-columns">
        <div>
            <p><strong>Cara</strong> <select class="score-input" id="memoria-cara" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Velcro</strong> <select class="score-input" id="memoria-velcro" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Iglesia</strong> <select class="score-input" id="memoria-iglesia" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Azul</strong> <select class="score-input" id="memoria-azul" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Cielo</strong> <select class="score-input" id="memoria-cielo" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>6. Atención (Series y Cálculo) - Máx. 6 puntos</h3>
    <div class="two-columns">
        <div>
            <p><strong>Atención:</strong> Repetir: 5-8-2 / 6-9-4 / 5-2-9</p>
            <p><strong>Serie 1</strong> <select class="score-input" id="serie1" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Serie 2</strong> <select class="score-input" id="serie2" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Serie 3</strong> <select class="score-input" id="serie3" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Cálculo:</strong> Restar 7 de 100 (5 veces): 100-7=93, 93-7=86...</p>
            <p><strong>Aciertos</strong> <select class="score-input" id="calculo" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select></p>
        </div>
    </div>

    <h3>7. Repetición de Frases (Lenguaje) - Máx. 2 puntos</h3>
    <p>Repetir: "El perro corrió tras el gato" / "Solo cuando llueve se moja"</p>
    <div class="two-columns">
        <div>
            <p><strong>Frase 1</strong> <select class="score-input" id="frase1" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Frase 2</strong> <select class="score-input" id="frase2" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>8. Fluidez Verbal (Lenguaje) - Máx. 1 punto</h3>
    <p>Decir el máximo de palabras que empiecen por "F" en 1 minuto (≥11 palabras = 1 punto)</p>
    <select class="score-input" id="fluidez" onchange="calculateScore()">
        <option value="0">0 (<11)</option>
        <option value="1">1 (≥11)</option>
    </select>

    <h3>9. Abstracción (Pensamiento Abstracto) - Máx. 2 puntos</h3>
    <p>Explicar similitudes entre: Plátano-Naranja / Tren-Bicicleta / Regla-Reloj</p>
    <div class="two-columns">
        <div>
            <p><strong>Pareja 1</strong> <select class="score-input" id="abstraccion1" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Pareja 2</strong> <select class="score-input" id="abstraccion2" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Pareja 3</strong> <select class="score-input" id="abstraccion3" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>10. Recuerdo Diferido (Memoria) - Máx. 5 puntos</h3>
    <p>Recordar las palabras de la sección 5 sin pistas:</p>
    <div class="two-columns">
        <div>
            <p><strong>Cara</strong> <select class="score-input" id="recuerdo-cara" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Velcro</strong> <select class="score-input" id="recuerdo-velcro" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Iglesia</strong> <select class="score-input" id="recuerdo-iglesia" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Azul</strong> <select class="score-input" id="recuerdo-azul" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Cielo</strong> <select class="score-input" id="recuerdo-cielo" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <h3>11. Orientación (Temporal/Espacial) - Máx. 6 puntos</h3>
    <div class="two-columns">
        <div>
            <p><strong>Fecha (día/mes/año)</strong> <select class="score-input" id="fecha" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Día de la semana</strong> <select class="score-input" id="dia" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Lugar (ciudad/hospital)</strong> <select class="score-input" id="lugar" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
        <div>
            <p><strong>Mes</strong> <select class="score-input" id="mes" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Año</strong> <select class="score-input" id="ano" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
            <p><strong>Piso/Planta</strong> <select class="score-input" id="piso" onchange="calculateScore()">
                <option value="0">0</option>
                <option value="1">1</option>
            </select></p>
        </div>
    </div>

    <div class="result" id="result">
        Puntuación TOTAL: <span id="totalScore">0</span>/30 puntos
    </div>
    <div class="result normal" id="interpretation">
        Interpretación: Normal (≥26 puntos)
    </div>
    <button onclick="printEvaluation()">Imprimir Evaluación</button>
    <p class="note">Puntuaciones de referencia: ≥26 = normal | ≤25 = deterioro cognitivo (ajustar por educación: +1 punto si ≤12 años de escolaridad)</p>

    <script>
        function calculateScore() {
            // Sección 1: Alternancia
            const alternancia = parseInt(document.getElementById('alternancia').value);
            
            // Sección 2: Cubo
            const cubo = parseInt(document.getElementById('cubo').value);
            
            // Sección 3: Reloj
            const relojContorno = parseInt(document.getElementById('reloj-contorno').value);
            const relojNumeros = parseInt(document.getElementById('reloj-numeros').value);
            const relojManecillas = parseInt(document.getElementById('reloj-manecillas').value);
            const relojTotal = relojContorno + relojNumeros + relojManecillas;
            
            // Sección 4: Denominación
            const leon = parseInt(document.getElementById('leon').value);
            const rinoceronte = parseInt(document.getElementById('rinoceronte').value);
            const camello = parseInt(document.getElementById('camello').value);
            const denominacionTotal = leon + rinoceronte + camello;
            
            // Sección 5: Memoria Inmediata
            const memoriaCara = parseInt(document.getElementById('memoria-cara').value);
            const memoriaVelcro = parseInt(document.getElementById('memoria-velcro').value);
            const memoriaIglesia = parseInt(document.getElementById('memoria-iglesia').value);
            const memoriaAzul = parseInt(document.getElementById('memoria-azul').value);
            const memoriaCielo = parseInt(document.getElementById('memoria-cielo').value);
            const memoriaTotal = memoriaCara + memoriaVelcro + memoriaIglesia + memoriaAzul + memoriaCielo;
            
            // Sección 6: Atención
            const serie1 = parseInt(document.getElementById('serie1').value);
            const serie2 = parseInt(document.getElementById('serie2').value);
            const serie3 = parseInt(document.getElementById('serie3').value);
            const calculo = parseInt(document.getElementById('calculo').value);
            const atencionTotal = serie1 + serie2 + serie3 + calculo;
            
            // Sección 7: Repetición de Frases
            const frase1 = parseInt(document.getElementById('frase1').value);
            const frase2 = parseInt(document.getElementById('frase2').value);
            const frasesTotal = frase1 + frase2;
            
            // Sección 8: Fluidez Verbal
            const fluidez = parseInt(document.getElementById('fluidez').value);
            
            // Sección 9: Abstracción
            const abstraccion1 = parseInt(document.getElementById('abstraccion1').value);
            const abstraccion2 = parseInt(document.getElementById('abstraccion2').value);
            const abstraccion3 = parseInt(document.getElementById('abstraccion3').value);
            const abstraccionTotal = abstraccion1 + abstraccion2 + abstraccion3;
            
            // Sección 10: Recuerdo Diferido
            const recuerdoCara = parseInt(document.getElementById('recuerdo-cara').value);
            const recuerdoVelcro = parseInt(document.getElementById('recuerdo-velcro').value);
            const recuerdoIglesia = parseInt(document.getElementById('recuerdo-iglesia').value);
            const recuerdoAzul = parseInt(document.getElementById('recuerdo-azul').value);
            const recuerdoCielo = parseInt(document.getElementById('recuerdo-cielo').value);
            const recuerdoTotal = recuerdoCara + recuerdoVelcro + recuerdoIglesia + recuerdoAzul + recuerdoCielo;
            
            // Sección 11: Orientación
            const fecha = parseInt(document.getElementById('fecha').value);
            const dia = parseInt(document.getElementById('dia').value);
            const lugar = parseInt(document.getElementById('lugar').value);
            const mes = parseInt(document.getElementById('mes').value);
            const ano = parseInt(document.getElementById('ano').value);
            const piso = parseInt(document.getElementById('piso').value);
            const orientacionTotal = fecha + dia + lugar + mes + ano + piso;
            
            // TOTAL (30 puntos)
            const totalScore = alternancia + cubo + relojTotal + denominacionTotal + memoriaTotal + 
                              atencionTotal + frasesTotal + fluidez + abstraccionTotal + 
                              recuerdoTotal + orientacionTotal;
            
            // Ajuste por educación (≤12 años: +1 punto)
            const education = parseInt(document.getElementById('education').value);
            const adjustedScore = education === 0 ? totalScore + 1 : totalScore;
            
            document.getElementById('totalScore').textContent = adjustedScore;
            
            // INTERPRETACIÓN
            const interpretation = document.getElementById('interpretation');
            if (adjustedScore >= 26) {
                interpretation.textContent = "Interpretación: Normal (≥26 puntos)";
                interpretation.className = "result normal";
            } else if (adjustedScore >= 18 && adjustedScore <= 25) {
                interpretation.textContent = "Interpretación: Deterioro cognitivo leve (18-25 puntos)";
                interpretation.className = "result suspicious";
            } else {
                interpretation.textContent = "Interpretación: Deterioro cognitivo moderado/grave (<18 puntos)";
                interpretation.className = "result abnormal";
            }
        }
        
        function printEvaluation() {
            window.print();
        }
        
        // Calcular puntuación inicial
        calculateScore();
    </script>
</div>
</body>
</html>